```{r warning = FALSE, message = FALSE,echo = FALSE}
source("../Scripts/DataProccess.R")

HFGData="../../UntrackedData/HFG data for stats preliminary 3-18-21.xlsx"

HFGFrame=HFGInfo(HFGData)%>%
  mutate(Filter=as.character(Filter),Well=as.character(Well))%>%
  filter(!is.na(N1Ct))%>%
  mutate(DayPlace=paste(Plant,Date))

HFGSumarized=HFGFrame%>%
  group_by(Plant,Date)%>%
  mutate(Ndat=n(),Ncat=length(unique(Filter)))%>%
  summarise(between=var(log(N1GC)),within=summary(aov(log(N1GC) ~ Filter))[1][[1]][[2]][1]/(Ndat-Ncat))
```


```{r fig.width=8, fig.height=8,echo = FALSE}
HFGSumarized%>%
  ggplot()+geom_point(aes(x=between,y=within))+
  geom_abline(intercept = 0, slope = 1)+
  scale_y_log10()+
  scale_x_log10()

HFGSumarized%>%
  ggplot()+geom_histogram(aes(x=between/within),bins = 30)+
  geom_vline(xintercept = 1,color="red")+
  scale_x_log10()+
  xlab("F Score")

#between=(x_i-mean_x)/(n-1)#(normally 8)
#within=(x_i-mean_filter)/(n-k)#(normally 6)
#if mean_x==mean_filter
#Then between*8=within*6
#IE between<within
```
```{r,echo = FALSE}
#just do the calc code
#look into package
#F-stat=sum^sq or sum abs()
#do that plot calculate it
#variance depends on magnitude=x=magnitude,y=variance numerator
#histogram of numerator and denominators
#chai squared
#once we know variance we can look for outliers
#var from one day to the next
```
